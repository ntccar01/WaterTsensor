<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº’å‹•å¼ NTC æº«åº¦æ„ŸçŸ¥å™¨æ¨¡æ“¬ (å«é›»è·¯åœ–)</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
            background-color: #f0f2f5;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 15px; /* æ¸›å°‘ body é‚Šè· */
            box-sizing: border-box;
        }

        .container {
            width: 100%;
            max-width: 750px; /* ç¨å¾®ç¸®å°å¯¬åº¦ */
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            padding: 25px; /* æ¸›å°‘å®¹å™¨å…§é‚Šè· */
            box-sizing: border-box;
        }

        h1 {
            text-align: center;
            color: #333;
            margin-top: 0;
            margin-bottom: 15px; /* æ¸›å°‘ h1 ä¸‹æ–¹é–“è· */
            font-size: 28px; /* ç¸®å° h1 å­—é«” */
        }

        p {
            font-size: 15px; /* ç¸®å° p å­—é«” */
            color: #555;
            line-height: 1.6;
            text-align: center;
            margin-bottom: 20px; /* æ¸›å°‘ p ä¸‹æ–¹é–“è· */
        }

        /* äº’å‹•æ§åˆ¶å€ */
        .controls {
            text-align: center;
            margin-bottom: 25px; /* æ¸›å°‘ controls ä¸‹æ–¹é–“è· */
        }

        .controls label {
            font-size: 17px; /* ç¸®å° label å­—é«” */
            font-weight: 600;
            color: #111;
        }

        #tempSlider {
            width: 80%;
            margin-top: 10px; /* æ¸›å°‘æ»‘æ¡¿ä¸Šæ–¹é–“è· */
            cursor: pointer;
        }

        #currentTempLabel {
            font-size: 22px; /* ç¸®å°æº«åº¦æ¨™ç±¤å­—é«” */
            font-weight: bold;
            color: #007bff;
            display: block;
            margin-top: 8px; /* æ¸›å°‘æº«åº¦æ¨™ç±¤ä¸Šæ–¹é–“è· */
        }

        /* ä¸»è¦æ¨¡æ“¬å€åŸŸ */
        .simulation {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            align-items: center;
            gap: 20px;
            /* ç§»é™¤ border-bottom å’Œ padding-bottom */
        }

        /* æ„ŸçŸ¥å™¨ */
        .sensor {
            flex-basis: 200px;
            background: #e9ecef;
            border: 2px solid #ced4da;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
        }

        .sensor-icon {
            font-size: 40px; /* ç¸®å°åœ–ç¤º */
        }
        
        .sensor h3 {
            margin-top: 10px;
            margin-bottom: 15px;
            font-size: 18px; /* ç¸®å°æ¨™é¡Œ */
        }

        .sensor-data {
            font-size: 16px; /* ç¸®å°å­—é«” */
            font-weight: 500;
            color: #495057;
        }

        #resistanceValue {
            font-weight: bold;
            font-size: 20px; /* ç¸®å°å­—é«” */
            color: #d9534f;
        }

        /* é›»è…¦ (ECU) */
        .ecu {
            flex-basis: 300px;
            background: #2c3e50;
            border: 2px solid #233140;
            border-radius: 8px;
            padding: 20px;
            color: white;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .ecu h3 {
            text-align: center;
            margin-top: 0;
            margin-bottom: 15px; /* æ¸›å°‘é–“è· */
            border-bottom: 1px solid #7f8c8d;
            padding-bottom: 10px;
            font-size: 20px; /* ç¸®å°æ¨™é¡Œ */
        }

        .display-group {
            display: flex;
            flex-direction: column;
            gap: 10px; /* æ¸›å°‘é¡¯ç¤ºæ¡†é–“è· */
        }

        .display-box {
            background: #1a252f;
            border-radius: 6px;
            padding: 12px 15px; /* æ¸›å°‘é¡¯ç¤ºæ¡†å…§é‚Šè· */
            border: 1px solid #4a637c;
        }

        .display-box label {
            font-size: 13px; /* ç¸®å°å­—é«” */
            color: #bdc3c7;
            display: block;
            margin-bottom: 4px; /* æ¸›å°‘é–“è· */
            text-transform: uppercase;
        }

        .display-box .value {
            font-size: 24px; /* ç¸®å°å­—é«” */
            font-weight: bold;
            font-family: 'Courier New', Courier, monospace;
            text-align: right;
            padding: 4px; /* æ¸›å°‘å…§é‚Šè· */
            background-color: #000;
            border-radius: 4px;
            color: #2ecc71;
        }
        
        /* é›»è·¯åœ–å€å¡Š */
        .circuit-diagram {
            width: 100%;
            text-align: center;
            margin-top: 15px; /* å¤§å¹…æ¸›å°‘é›»è·¯åœ–ä¸Šæ–¹é–“è· */
        }
        
        .circuit-diagram h3 {
            color: #333;
            font-weight: 600;
            margin-bottom: 10px; /* æ¸›å°‘é–“è· */
            font-size: 18px; /* ç¸®å°æ¨™é¡Œ */
        }

        /* SVG é›»è·¯åœ–æ¨£å¼ */
        .circuit-svg {
            width: 100%;
            max-width: 600px;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Microsoft JhengHei", Roboto, Helvetica, Arial, sans-serif;
            font-size: 13px;
            overflow: visible; 
        }

        /* é›»è·¯ç·š */
        .circuit-line { stroke: #333; stroke-width: 2; fill: none; }
        #voltage-gradient-path { stroke: url(#voltageGradient); stroke-width: 6; fill: none; }
        .resistor-body { stroke: #333; stroke-width: 2; fill: none; }
        .ntc-line { stroke: #555; stroke-width: 2; }
        .circuit-label { fill: #111; font-weight: bold; }
        .circuit-sub-label { fill: #555; font-size: 12px; }
        .vout-tap { stroke: #007bff; stroke-width: 2; fill: none; }
        .vout-dot { fill: #007bff; }
        .vout-label { fill: #007bff; font-weight: bold; font-size: 16px; }
        .gnd-symbol-line { stroke: #333; stroke-width: 2; }

    </style>
</head>
<body>

    <div class="container">
        <h1>äº’å‹•å¼ NTC æº«åº¦æ„ŸçŸ¥å™¨æ¨¡æ“¬</h1>
        <p>
            é€™æ˜¯ä¸€å€‹æ¨¡æ“¬æ±½è»Šæº«åº¦æ„ŸçŸ¥å™¨ (NTC) çš„ç¶²é ã€‚NTC æ˜¯ã€Œè² æº«åº¦ä¿‚æ•¸ã€çš„ç¸®å¯«ï¼Œä»£è¡¨
            <strong>æº«åº¦è¶Šé«˜ï¼Œé›»é˜»å€¼è¶Šä½</strong>ã€‚
        </p>

        <div class="controls">
            <label for="tempSlider">æ‹–å‹•æ»‘æ¡¿ä¾†æ”¹è®Šç›®å‰æº«åº¦ï¼š</label>
            <span id="currentTempLabel">25.0 Â°C</span>
            <input type="range" id="tempSlider" min="-20" max="120" value="25" step="0.1">
        </div>

        <div class="simulation">

            <div class="sensor">
                <div class="sensor-icon">ğŸŒ¡ï¸</div>
                <h3>æº«åº¦æ„ŸçŸ¥å™¨ (NTC)</h3>
                <div class="sensor-data">
                    ç›®å‰é›»é˜»å€¼:
                    <span id="resistanceValue">10000 Î©</span>
                </div>
            </div>

            <div class="ecu">
                <h3>æ±½è»Šé›»è…¦ (ECU)</h3>
                <div class="display-group">
                    <div class="display-box">
                        <label>è¨Šè™Ÿé›»å£“ (V_out)</label>
                        <div class="value" id="voltageDisplay">2.50 V</div>
                    </div>
                    <div class="display-box">
                        <label>è§£è®€æº«åº¦</label>
                        <div class="value" id="tempDisplay">25.0 Â°C</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="circuit-diagram">
            <h3>ECU å…§éƒ¨ç°¡åŒ–é›»è·¯ (åˆ†å£“é›»è·¯)</h3>
            
            <svg class="circuit-svg" viewBox="0 0 400 180">
                <defs>
                    <linearGradient id="voltageGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                        <stop id="grad-stop1" offset="0%" style="stop-color:#d9534f; stop-opacity:1" />
                        <stop id="grad-stop2" offset="50%" style="stop-color:#f0ad4e; stop-opacity:1" />
                        <stop id="grad-stop3" offset="100%" style="stop-color:#5bc0de; stop-opacity:1" />
                    </linearGradient>
                </defs>

                <path id="voltage-gradient-path" d="M 50 50 L 130 50 L 170 50 L 230 50 L 270 50 L 350 50" />
                
                <text x="25" y="55" text-anchor="middle" class="circuit-label">5V</text>
                <text x="25" y="70" text-anchor="middle" class="circuit-sub-label">(é›»è…¦åƒè€ƒé›»å£“)</text>
                <circle cx="50" cy="50" r="4" fill="#d9534f" />
                <line class="circuit-line" x1="50" y1="50" x2="130" y2="50" />
                
                <path class="resistor-body" d="M 130 50 l 5 -10 l 10 20 l 10 -20 l 10 20 l 5 -10" />
                <text x="150" y="10" text-anchor="middle" class="circuit-label">å›ºå®šé›»é˜»</text>
                <text x="150" y="25" text-anchor="middle" class="circuit-sub-label">(10kÎ©)</text>
                
                <line class="circuit-line" x1="170" y1="50" x2="230" y2="50" />
                <line class="vout-tap" x1="200" y1="50" x2="200" y2="100" />
                <circle class="vout-dot" cx="200" cy="50" r="4" />
                <text x="200" y="120" text-anchor="middle" class="vout-label" id="vout-label-text">V_out: 2.50V</text>
                <text x="200" y="135" text-anchor="middle" class="circuit-sub-label">(ECU è®€å–é»)</text>

                <path class="resistor-body" d="M 230 50 l 5 -10 l 10 20 l 10 -20 l 10 20 l 5 -10" />
                <line class="ntc-line" x1="225" y1="70" x2="275" y2="30" />
                <text x="250" y="10" text-anchor="middle" class="circuit-label">æº«åº¦æ„ŸçŸ¥å™¨</text>
                <text x="250" y="25" text-anchor="middle" class="circuit-sub-label">(NTC: <tspan id="ntc-label-resistance">10kÎ©</tspan>)</text>
                <text x="275" y="70" text-anchor="middle" class="circuit-label">tÂ°</text> 
                
                <line class="circuit-line" x1="270" y1="50" x2="350" y2="50" />
                <text x="375" y="55" text-anchor="middle" class="circuit-label">GND</text>
                <text x="375" y="70" text-anchor="middle" class="circuit-sub-label">(0V)</text>
                <line class="gnd-symbol-line" x1="350" y1="50" x2="350" y2="70" />
                <line class="gnd-symbol-line" x1="335" y1="70" x2="365" y2="70" />
                <line class="gnd-symbol-line" x1="340" y1="75" x2="360" y2="75" />
                <line class="gnd-symbol-line" x1="345" y1="80" x2="355" y2="80" />

            </svg>
        </div>
    </div>

    <script>
        // --- æ¨¡æ“¬åƒæ•¸ (å¯èª¿æ•´) ---
        const R_FIXED = 10000; // 10,000 Ohms (10kÎ©)
        const V_REF = 5.0; // 5 Volts
        const R0 = 10000; // åœ¨ T0 æ™‚çš„é›»é˜» (10kÎ©)
        const T0 = 25 + 273.15; // åƒè€ƒæº«åº¦ (25Â°C)ï¼Œè½‰æ›ç‚ºå‡±æ°æº«åº¦ (K)
        const B_VALUE = 3950; // NTC çš„ B ä¿‚æ•¸ (å…¸å‹å€¼)

        // --- ç²å–é é¢å…ƒç´  ---
        const tempSlider = document.getElementById('tempSlider');
        const currentTempLabel = document.getElementById('currentTempLabel');
        const resistanceValue = document.getElementById('resistanceValue');
        const voltageDisplay = document.getElementById('voltageDisplay');
        const tempDisplay = document.getElementById('tempDisplay');
        
        // --- ç²å– SVG é›»è·¯åœ–ç›¸é—œå…ƒç´  ---
        const voutLabelText = document.getElementById('vout-label-text');
        const ntcLabelResistance = document.getElementById('ntc-label-resistance');
        const gradStop2 = document.getElementById('grad-stop2'); // æ¼¸å±¤çš„ä¸­é–“é»

        // --- æ ¸å¿ƒæ›´æ–°å‡½å¼ ---
        function updateSimulation() {
            // 1. ç²å–ç•¶å‰æº«åº¦ (æ”æ° Â°C)
            let currentTempC = parseFloat(tempSlider.value);
            
            // 2. å°‡æº«åº¦è½‰æ›ç‚ºå‡±æ° (K)
            let currentTempK = currentTempC + 273.15;

            // 3. è¨ˆç®— NTC é›»é˜»å€¼ (R_sensor)
            let rSensor = R0 * Math.exp(B_VALUE * (1 / currentTempK - 1 / T0));

            // 4. è¨ˆç®—åˆ†å£“é›»è·¯çš„è¼¸å‡ºé›»å£“ (V_out)
            let vOut = V_REF * (rSensor / (R_FIXED + rSensor));

            // 5. æ›´æ–°ç¶²é ä¸Šçš„é¡¯ç¤ºå…§å®¹
            
            // æ›´æ–°æ»‘æ¡¿æ¨™ç±¤
            currentTempLabel.textContent = currentTempC.toFixed(1) + ' Â°C';

            // æ›´æ–°æ„ŸçŸ¥å™¨é›»é˜»
            resistanceValue.textContent = rSensor.toFixed(0) + ' Î©';
            
            // æ›´æ–° ECU é¡¯ç¤ºæ¡†
            voltageDisplay.textContent = vOut.toFixed(2) + ' V';
            tempDisplay.textContent = currentTempC.toFixed(1) + ' Â°C';

            // 6. --- æ›´æ–° SVG é›»è·¯åœ– ---
            
            // æ›´æ–° V_out æ¨™ç±¤çš„é›»å£“æ–‡å­—
            voutLabelText.textContent = 'V_out: ' + vOut.toFixed(2) + 'V';
            
            // æ›´æ–° NTC é›»é˜»æ¨™ç±¤çš„é›»é˜»å€¼
            if (rSensor >= 1000) {
                ntcLabelResistance.textContent = (rSensor / 1000).toFixed(1) + 'kÎ©';
            } else {
                ntcLabelResistance.textContent = rSensor.toFixed(0) + 'Î©';
            }
            
            // å‹•æ…‹æ›´æ–°æ¼¸å±¤ï¼
            let vOutPercentageOfTotalVoltage = vOut / V_REF;
            let offsetPercentage = (1 - vOutPercentageOfTotalVoltage) * 100;
            gradStop2.setAttribute('offset', offsetPercentage + '%');
        }

        // --- äº‹ä»¶ç›£è½ ---
        tempSlider.addEventListener('input', updateSimulation);

        // --- é é¢è¼‰å…¥æ™‚ï¼Œå…ˆåŸ·è¡Œä¸€æ¬¡ ---
        updateSimulation();

    </script>
</body>
</html>